Bootstrap: docker
From: condaforge/miniforge3
Stage: conda

%post
    mamba create -q -y -p /conda_env \
        plotly \
        dash \
        numpy \
        gunicorn \
        pandas \
        geojson
        # scikit-learn \
        # werkzeug


Bootstrap: docker
From: ubuntu
Stage: final

%files from conda
    /conda_env /

%environment
    PATH=/conda_env/bin:$PATH
    PYTHONDONTWRITEBYTECODE=1

%startscript
    export PYTHONDONTWRITEBYTECODE=1
    gunicorn --bind 0.0.0.0:$@ app:server